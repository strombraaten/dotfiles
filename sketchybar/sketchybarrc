#!/bin/bash

# Vertical SketchyBar Configuration
# Inspired by https://github.com/iyioon/sketchybar
# Modified for left-side vertical layout

PLUGIN_DIR="$CONFIG_DIR/plugins"

# Theme colors (cyberdream)
BG_COLOR="0xff16181a"
FG_COLOR="0xffe0e0e0"
DIM_COLOR="0xff7b8496"
ACCENT_COLOR="0xffff5ef1"
BORDER_COLOR="0xff2a3a4a"

##### Bar Appearance #####
# Vertical bar positioned on the left side
sketchybar --bar position=left \
                height=60 \
                sticky=on \
                topmost=off \
                shadow=on \
                y_offset=5 \
                margin=5 \
                padding_left=16 \
                padding_right=16 \
                color=$BG_COLOR \
                border_color=$BORDER_COLOR \
                border_width=1 \
                corner_radius=10 \
                font_smoothing=on

##### Changing Defaults #####
default=(
  icon.font="Hack Nerd Font:Regular:13"
  label.font="Source Code Pro:Regular:13"
  icon.color=$DIM_COLOR
  label.color=$ACCENT_COLOR
  padding_left=10
  padding_right=10
  icon.padding_right=4
  icon.highlight_color=$ACCENT_COLOR
)
sketchybar --default "${default[@]}"

##### Adding Workspace Indicators (Top Section) #####
for sid in $(seq 1 5); do
  sketchybar --add item space.$sid left \
             --set space.$sid \
               icon.drawing=on \
               label.font="Hack Nerd Font:Regular:11" \
               label="$sid" \
               label.color=$FG_COLOR \
               click_script="aerospace workspace $sid" \
               script="$PLUGIN_DIR/space.sh $sid"
done

# Separator
sketchybar --add item sep1 left \
           --set sep1 \
             label="───────" \
             padding_left=14 \
             padding_right=14 \
             icon.drawing=off \
             label.font.size=9.0 \
             label.color=$DIM_COLOR

##### Adding System Items (Bottom Section) #####
# Battery
sketchybar --add item battery right \
           --set battery \
             script="$PLUGIN_DIR/battery.sh" \
             update_freq=120 \
             label.color=$FG_COLOR \
             icon.color=$FG_COLOR
sketchybar --subscribe battery system_woke power_source_change

# Volume
sketchybar --add item volume right \
           --set volume \
             script="$PLUGIN_DIR/volume.sh" \
             label.color=$FG_COLOR \
             icon.color=$FG_COLOR
sketchybar --subscribe volume volume_change

# Clock
sketchybar --add item clock right \
           --set clock \
             script="$PLUGIN_DIR/clock.sh" \
             update_freq=30 \
             icon.drawing=off \
             label.font.size=16 \
             label.color=$FG_COLOR \
             padding_left=0 \
             padding_right=10

##### Force all scripts to run the first time #####
sketchybar --update